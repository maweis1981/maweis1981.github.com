--- 
wordpress_id: 136
layout: post
title: Sun-JDK,Tomcat,Tomcat-native On FreeBSD,
wordpress_url: http://maweis.com/index.php/archives/136.html
---
<p>首先安装diablo-jdk</p>  <p>参加freebsdchina老妖的文章</p>  <p><a href="http://www.freebsdchina.org/viewtopic.php?t=35885&amp;start=0&amp;postdays=0&amp;postorder=asc&amp;highlight=&amp;sid=9e530dc881b8dce3478f34fdfc81d43e">FreeBSD 最小化安装 ＋diablo-jdk ＋Apache 与 Tomcat 整合 。</a></p>  <p>装完之后更改jdk为sun官方jdk</p>  <p>#cd /usr/ports/java/jdk15</p>  <p>#make install</p>  <p>然后按照系统提示去下载一系列的文件</p>  <p>jdk-1_5_0_13-fcs-bin-b05-jrl-25_sep_2007.jar    <br />jdk-1_5_0_13-fcs-src-b05-jrl-25_sep_2007.jar     <br />tzupdater-1_2_2-2007g.zip     <br />bsd-jdk15-patches-7.tar.bz2     <br />jce_policy-1_5_0.zip</p>  <p>然后copy到/usr/ports/distfiles,然后继续按照屏幕提示安装</p>  <p>当你看到一个选择界面的时候你可以把debug选项去掉，如果你是当作服务器的话，其他根据你自己的需求，如果这儿选择了IPV6的，那么在下面需要你增加一行配置，我就是因为这个而折腾了一下午的。</p>  <p>当jdk15装好后，你就可以pkg_delete 掉你的diablo-jdk了，具体你要查看</p>  <p>pkg_info|grep diablo-jdk了。</p>  <p>然后安装tomcat-native</p>  <p># cd /usr/local/apache-tomcat6.0/bin    <br /># tar xvf tomcat-native.tar.gz     <br /># cd ./tomcat-native-1.1.10-src/jni/native/     <br /># setenv JAVA_HOME /usr/local/diablo-jdk1.5.0/     <br /># ./configure --with-apr=/usr/local     <br /># make     <br /># make install </p>  <p><strong><font color="#ff0000">在这个地方如果安装的时候提示你找不到jdk，那么你就手工在configure文件中手工加上JAVA_HOME的设定</font></strong></p>  <p><strong></strong>    <br />安装好了之后会有个提示：     <br />----------------------------------------------------------------------     <br />Libraries have been installed in:     <br />/usr/local/apr/lib     <br />If you ever happen to want to link against installed libraries     <br />in a given directory, LIBDIR, you must either use libtool, and     <br />specify the full pathname of the library, or use the `-LLIBDIR'     <br />flag during linking and do at least one of the following:     <br />- add LIBDIR to the `LD_LIBRARY_PATH' environment variable     <br />during execution     <br />- add LIBDIR to the `LD_RUN_PATH' environment variable     <br />during linking     <br />- use the `-Wl,--rpath -Wl,LIBDIR' linker flag     <br />See any operating system documentation about shared libraries for     <br />more information, such as the ld(1) and ld.so(8) manual pages.     <br />----------------------------------------------------------------------     <br />安装后多出一个目录 /usr/local/apr     <br />然后安装上面的提示操作一下就好了，我这里用的 link 的方式：     <br /># ln -s /usr/local/apr/lib/libtcnative-1.so /usr/local/diablo-jdk1.5.0/jre/lib/i386/libtcnative-1.so </p>  <p><font color="#ff0000"><strong>然后如果你前面设置了ipv6的，现在请在/usr/local/etc/rc.d/tomcat6文件中</strong></font>    <p><strong>java_command=&quot;*********&quot;,星号部分代表原文件配置代码，</strong></p>    <p><strong>在星号部分增加</strong></p>    <p><strong>-Djava.net.preferIPv4Stack=true</strong></p> </p>  <p>如果这儿没有增加，那么你将遇到</p>  <p>Oct 30, 2007 11:36:41 PM org.apache.catalina.core.StandardServer await    <br />SEVERE: StandardServer.await: create[8005]:     <br />java.net.BindException: Can't assign requested address     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at java.net.PlainSocketImpl.socketBind(Native Method)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:359)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at java.net.ServerSocket.bind(ServerSocket.java:319)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at java.net.ServerSocket.&lt;init&gt;(ServerSocket.java:185)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at org.apache.catalina.core.StandardServer.await(StandardServer.java:363)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at org.apache.catalina.startup.Catalina.await(Catalina.java:616)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at org.apache.catalina.startup.Catalina.start(Catalina.java:576)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at java.lang.reflect.Method.invoke(Method.java:585)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)     <br />&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433)</p>  <p>这样的错误信息。    </p>
